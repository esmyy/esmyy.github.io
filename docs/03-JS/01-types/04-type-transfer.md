# 类型转换

JS 中各种转换规则很纷杂，理解和掌握是有理解和记忆难度的。

## toString

需要转换为字符串的常用场景主要有

| 场景         | 示例 |
| ------------ | ---- |
| 值的相等比较 |      |
| 类型判断     |      |
| 数字转字符串 |      |
| 数组转字符串 |      |
| 对象转字符串 |      |

### Primitive

基础类型的转换比较简单，最简单的方式是与一个空字符串`''`相加，基本上就是原来的内容转换成字符串形式。

```js
null + ""; // 'null'
undefined + ""; // 'undefined'
true + ""; // 'true'
1 + ""; // '1'
```

也有一些特殊情况，但不复杂

```js
0.0000000001 + ""; // '1e-10' 数字特别大或者特别小会变成指数形式
Symbol("foo").toString(); // 'Symbol(foo)'
```

其中 Symbol 的字符串更多只是便于区分，日常开发中也不需要将其转换为字符串。

### Array

数组转字符串

```js
[1, 2, 3].toString(); // '1,2,3'
```

默认情况下，`toString` 其实就是尝试调用 `join`，join 的默认拼接字符是 `,`。
如果覆盖了 toString 或者 join 可能会得到不同的结果。

```js
const arr = [1, 2, 3];
arr.join = "wow";
arr.toString(); // [object Array]
```

如上所示，覆盖 join 为一个非函数，将会调用 Object.prototype.toString。

## toNumber

非数字转数字，开发过程中使用到的基本都是字符串转数字

其中比较值得注意的有几个

- `+` 二元运算，一元操作引起的转换，执行与 `Number()` 一样的转换
- `==` 比较隐式转换

### 小结

原则是

- 减少类型转换
- 避免隐式转换
- 限制强制转换

像 `==` 这样的，虽然有时候恰好是会有比较巧妙的实现，但我会避免使用。

而像`+`这样的，就约束字符串只包含数字字符这样的前提。
