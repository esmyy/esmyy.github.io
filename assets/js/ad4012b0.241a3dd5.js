"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[9246],{3905:(e,n,o)=>{o.d(n,{Zo:()=>s,kt:()=>d});var t=o(7294);function i(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function r(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),o.push.apply(o,t)}return o}function l(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?r(Object(o),!0).forEach((function(n){i(e,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))}))}return e}function p(e,n){if(null==e)return{};var o,t,i=function(e,n){if(null==e)return{};var o,t,i={},r=Object.keys(e);for(t=0;t<r.length;t++)o=r[t],n.indexOf(o)>=0||(i[o]=e[o]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)o=r[t],n.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(i[o]=e[o])}return i}var a=t.createContext({}),c=function(e){var n=t.useContext(a),o=n;return e&&(o="function"==typeof e?e(n):l(l({},n),e)),o},s=function(e){var n=c(e.components);return t.createElement(a.Provider,{value:n},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},k=t.forwardRef((function(e,n){var o=e.components,i=e.mdxType,r=e.originalType,a=e.parentName,s=p(e,["components","mdxType","originalType","parentName"]),m=c(o),k=i,d=m["".concat(a,".").concat(k)]||m[k]||u[k]||r;return o?t.createElement(d,l(l({ref:n},s),{},{components:o})):t.createElement(d,l({ref:n},s))}));function d(e,n){var o=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=o.length,l=new Array(r);l[0]=k;var p={};for(var a in n)hasOwnProperty.call(n,a)&&(p[a]=n[a]);p.originalType=e,p[m]="string"==typeof e?e:i,l[1]=p;for(var c=2;c<r;c++)l[c]=o[c];return t.createElement.apply(null,l)}return t.createElement.apply(null,o)}k.displayName="MDXCreateElement"},9258:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>u,frontMatter:()=>r,metadata:()=>p,toc:()=>c});var t=o(7462),i=(o(7294),o(3905));const r={},l="compiler",p={unversionedId:"project/bundler/webpack/compiler",id:"project/bundler/webpack/compiler",title:"compiler",description:"compiler \u4fdd\u5b58\u914d\u7f6e\u4fe1\u606f\uff0c\u6839\u636e\u914d\u7f6e\u5b9a\u4e49\u548c\u53d1\u5e03\u4e8b\u4ef6\uff0c\u8d1f\u8d23\u6574\u4f53\u7684\u8c03\u5ea6\u3002",source:"@site/docs/10-project/bundler/01-webpack/03-compiler.md",sourceDirName:"10-project/bundler/01-webpack",slug:"/project/bundler/webpack/compiler",permalink:"/docs/project/bundler/webpack/compiler",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/10-project/bundler/01-webpack/03-compiler.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\u51c6\u5907\u5de5\u4f5c",permalink:"/docs/project/bundler/webpack/prepare"},next:{title:"compilation",permalink:"/docs/project/bundler/webpack/compilation/"}},a={},c=[{value:"\u524d\u7f6e\u6982\u89c8",id:"\u524d\u7f6e\u6982\u89c8",level:2},{value:"\u5b9e\u4f8b\u5316",id:"\u5b9e\u4f8b\u5316",level:2},{value:"\u63d2\u4ef6\u5b89\u88c5",id:"\u63d2\u4ef6\u5b89\u88c5",level:2},{value:"\u53d1\u5e03\u73af\u5883\u4e8b\u4ef6",id:"\u53d1\u5e03\u73af\u5883\u4e8b\u4ef6",level:2},{value:"\u5185\u7f6e\u63d2\u4ef6\u5b89\u88c5",id:"\u5185\u7f6e\u63d2\u4ef6\u5b89\u88c5",level:2},{value:"\u51c6\u5907\u5f00\u59cb\u7f16\u8bd1",id:"\u51c6\u5907\u5f00\u59cb\u7f16\u8bd1",level:2},{value:"\u5c0f\u7ed3",id:"\u5c0f\u7ed3",level:2}],s={toc:c},m="wrapper";function u(e){let{components:n,...o}=e;return(0,i.kt)(m,(0,t.Z)({},s,o,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"compiler"},"compiler"),(0,i.kt)("p",null,"compiler \u4fdd\u5b58\u914d\u7f6e\u4fe1\u606f\uff0c\u6839\u636e\u914d\u7f6e\u5b9a\u4e49\u548c\u53d1\u5e03\u4e8b\u4ef6\uff0c\u8d1f\u8d23\u6574\u4f53\u7684\u8c03\u5ea6\u3002"),(0,i.kt)("h2",{id:"\u524d\u7f6e\u6982\u89c8"},"\u524d\u7f6e\u6982\u89c8"),(0,i.kt)("p",null,"\u7701\u7565\u4e86\u6682\u65f6\u4e0d\u5fc5\u5173\u6ce8\u7684\u5185\u5bb9\uff0cwebpack \u5b9a\u4e49\u8fc7\u7a0b\u5982\u4e0b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="lib/webpack.js"',title:'"lib/webpack.js"'},"const webpack = (options, callback) => {\n  // \u521b\u5efa\u7f16\u8bd1\u5668\n  let compiler = createCompiler(options);\n\n  // ...\n\n  // \u6267\u884c\u7f16\u8bd1\n  compiler.run();\n\n  return compiler;\n};\n")),(0,i.kt)("p",null,"options \u53ef\u7406\u89e3\u4e3a ",(0,i.kt)("inlineCode",{parentName:"p"},"webpack.config.js")," \u914d\u7f6e\uff0ccallback \u6682\u4e0d\u7528\u5173\u6ce8\u3002createCompiler \u5982\u4e0b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="lib/webpack.js"',title:'"lib/webpack.js"'},'const createCompiler = (options) => {\n  // 1. \u8bbe\u7f6e\u9ed8\u8ba4\u914d\u7f6e\uff0c\u5e76\u4e0eoptions\u7684\u914d\u7f6e\u5408\u5e76\uff0c\u521d\u59cb\u5316 compiler\n  options = new WebpackOptionsDefaulter().process(options);\n  const compiler = new Compiler(options.context);\n  compiler.options = options;\n\n  // 2. \u5b89\u88c5\u63d2\u4ef6\n  new NodeEnvironmentPlugin({\n    infrastructureLogging: options.infrastructureLogging,\n  }).apply(compiler);\n\n  if (Array.isArray(options.plugins)) {\n    for (const plugin of options.plugins) {\n      if (typeof plugin === "function") {\n        plugin.call(compiler, compiler);\n      } else {\n        plugin.apply(compiler);\n      }\n    }\n  }\n\n  // 3. \u53d1\u5e03\u73af\u5883\u72b6\u6001\u4e8b\u4ef6\n  compiler.hooks.environment.call();\n  compiler.hooks.afterEnvironment.call();\n\n  // 4. \u6839\u636e options \u8bbe\u7f6e\u63d2\u4ef6\n  compiler.options = new WebpackOptionsApply().process(options, compiler);\n  return compiler;\n};\n')),(0,i.kt)("p",null,"\u5185\u5bb9\u5f88\u591a\uff0c\u5df2\u7ecf\u5728\u4ee3\u7801\u4e2d\u505a\u4e86\u7b80\u8981\u6ce8\u91ca\uff0c\u4e0b\u9762\u5206\u8282\u4ecb\u7ecd\u3002"),(0,i.kt)("h2",{id:"\u5b9e\u4f8b\u5316"},"\u5b9e\u4f8b\u5316"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"compiler = new Compiler(options.context);\ncompiler.options = options;\n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"options.context")," \u662f\u6267\u884c\u65f6\u6307\u5b9a\u7684\u914d\u7f6e\u6587\u4ef6\u6240\u5728\u7684\u76ee\u5f55\uff0c\u5982\u4e0b\u5c31\u662f config \u76ee\u5f55\u7684\u8def\u5f84\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell"},"config\n\u2514\u2500\u2500 webpack.config.js\n")),(0,i.kt)("p",null,"Compiler \u7684\u5b9a\u4e49 \u5982\u4e0b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'const {\n  SyncHook,\n  SyncBailHook,\n  AsyncParallelHook,\n  AsyncSeriesHook,\n} = require("tapable");\n\nclass Compiler {\n  /**\n   * @param {string} context the compilation path\n   */\n  constructor(context) {\n    // \u5b9a\u4e49\u94a9\u5b50\n    this.hooks = Object.freeze({\n      shouldEmit: new SyncBailHook(["compilation"]),\n      done: new AsyncSeriesHook(["stats"]),\n      /** @type {SyncHook<[Stats]>} */\n      afterDone: new SyncHook(["stats"]),\n      /** @type {AsyncSeriesHook<[]>} */\n      additionalPass: new AsyncSeriesHook([]),\n      /** @type {AsyncSeriesHook<[Compiler]>} */\n      beforeRun: new AsyncSeriesHook(["compiler"]),\n      /** @type {AsyncSeriesHook<[Compiler]>} */\n      run: new AsyncSeriesHook(["compiler"]),\n      /** @type {AsyncSeriesHook<[Compilation]>} */\n      emit: new AsyncSeriesHook(["compilation"]),\n      /** @type {AsyncSeriesHook<[string, AssetEmittedInfo]>} */\n      assetEmitted: new AsyncSeriesHook(["file", "info"]),\n      /** @type {AsyncSeriesHook<[Compilation]>} */\n      afterEmit: new AsyncSeriesHook(["compilation"]),\n      // ...\u7701\u7565\u5176\u4ed6 hooks \u5b9a\u4e49\n    });\n\n    this.context = context;\n    this.options = /** @type {WebpackOptions} */ ({});\n\n    // ...\u4e00\u5806\u5c5e\u6027\u521d\u59cb\u5316\n  }\n\n  // ...\u5b9e\u4f8b\u5316\u8fc7\u7a0b\u4e0d\u8c03\u7528\u5176\u4ed6\u65b9\u6cd5\uff0c\u6682\u4e0d\u7528\u5173\u6ce8\n}\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"compiler.hooks")," \u5b9a\u4e49\u4e86 compiler \u6240\u652f\u6301\u7684\u6240\u6709\u4e8b\u4ef6\uff0c\u5177\u4f53\u53ef\u53c2\u8003",(0,i.kt)("a",{parentName:"p",href:"https://webpack.js.org/api/compiler-hooks/"},"Compiler Hooks"),"\uff0c\u7531\u6b64 compiler \u5177\u5907\u4e86\u4e8b\u4ef6\u53d1\u5e03/\u8ba2\u9605\u7684\u80fd\u529b\u3002compiler \u6267\u884c\u8fc7\u7a0b\u4e2d\u5728\u5bf9\u5e94\u7684\u8282\u70b9\u4f1a\u53d1\u5e03\u76f8\u5e94\u7684\u4e8b\u4ef6\uff0c\u89e6\u53d1\u5df2\u6ce8\u518c\u7684\u5904\u7406\u51fd\u6570\u6267\u884c\u3002"),(0,i.kt)("h2",{id:"\u63d2\u4ef6\u5b89\u88c5"},"\u63d2\u4ef6\u5b89\u88c5"),(0,i.kt)("p",null,"\ud83d\udc68\u200d\ud83d\udcbb\u200d Go On... \ud83d\udc68\u200d\ud83d\udcbb\u200d"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'const createCompiler = (options) => {\n  // ...\n  new NodeEnvironmentPlugin({\n    infrastructureLogging: options.infrastructureLogging,\n  }).apply(compiler);\n\n  if (Array.isArray(options.plugins)) {\n    for (const plugin of options.plugins) {\n      if (typeof plugin === "function") {\n        plugin.call(compiler, compiler);\n      } else {\n        plugin.apply(compiler);\n      }\n    }\n  }\n\n  // ...\n};\n')),(0,i.kt)("p",null,"\u63d2\u4ef6\u5177\u6709\u7edf\u4e00\u7684\u7ed3\u6784\uff0c\u90fd\u662f\u901a\u8fc7 apply \u51fd\u6570\u8fdb\u884c\u5b89\u88c5\uff0c\u800c\u4e14 apply \u7684\u53c2\u6570\u90fd\u662f compiler\uff0c\u8fd9\u4e2a\u51fd\u6570\u7684\u4e3b\u8981\u4f5c\u7528\u662f\u6ce8\u518c\u7f16\u8bd1\u8fc7\u7a0b\u7684\u4e8b\u4ef6\u5904\u7406\u51fd\u6570\uff0c\u4e5f\u53ef\u4ee5\u5728 compiler \u4e0a\u5b9a\u4e49\u4e00\u4e9b\u5c5e\u6027\u3002\u4ee5\u8fd9\u91cc\u7684 NodeEnvironmentPlugin \u4e3a\u4f8b\uff0c\u5b83\u6700\u7ec8\u662f\u7ed9 beforeRun \u6dfb\u52a0\u4e00\u4e2a\u8ba2\u9605\u51fd\u6570\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'class NodeEnvironmentPlugin {\n  constructor(options) {\n    this.options = options || {};\n  }\n\n  apply(compiler) {\n    // ...\u7701\u7565\n    compiler.hooks.beforeRun.tap("NodeEnvironmentPlugin", (compiler) => {\n      // ...\n    });\n  }\n}\n')),(0,i.kt)("p",null,"\u5177\u4f53\u7684\u63d2\u4ef6\u673a\u5236\uff0c\u4e00\u4e9b\u63d2\u4ef6\u7684\u91cd\u8981\u80fd\u529b\uff0c\u8fd9\u91cc\u6682\u4e14\u4e0d\u63d0\uff0cNodeEnvironmentPlugin \u5176\u5b9e\u6709\u5f88\u591a\u91cd\u8981\u4f5c\u7528\uff0c\u8fd9\u91cc\u90fd\u6682\u4e14\u4e0d\u63d0\u3002"),(0,i.kt)("admonition",{title:"\ud83e\udd14",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"\u5728 compiler \u521d\u59cb\u5316\u4e4b\u540e\u662f\u6267\u884c\u63d2\u4ef6\u7684\u5b89\u88c5\uff0c\u63d2\u4ef6\u7684\u5b89\u88c5\u662f\u8ba2\u9605\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\u7684\u4e8b\u4ef6\u3002")),(0,i.kt)("h2",{id:"\u53d1\u5e03\u73af\u5883\u4e8b\u4ef6"},"\u53d1\u5e03\u73af\u5883\u4e8b\u4ef6"),(0,i.kt)("p",null,"\ud83d\udc68\u200d\ud83d\udcbb\u200d Go On... \ud83d\udc68\u200d\ud83d\udcbb\u200d \u5728\u5b9a\u4e49\u4e86\u4e8b\u4ef6\uff0c\u4e5f\u6dfb\u52a0\u4e86\u4e00\u4e9b\u8ba2\u9605\u4e8b\u4ef6\u4e4b\u540e\uff0c\u662f\u5185\u7f6e\u7684\u73af\u5883\u76f8\u5173\u4e8b\u4ef6\u7684\u53d1\u5e03\uff0c\u5982\u4e0b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"const createCompiler = (options) => {\n  // ...\u53d1\u5e03\u73af\u5883\u72b6\u6001\u76f8\u5173\u7684\u4e8b\u4ef6\n  compiler.hooks.environment.call();\n  compiler.hooks.afterEnvironment.call();\n\n  // \u6839\u636eoptions \u8bbe\u7f6e\u63d2\u4ef6\n  compiler.options = new WebpackOptionsApply().process(options, compiler);\n  return compiler;\n};\n")),(0,i.kt)("p",null,"\u8fd9\u5c31\u8868\u793a\u73af\u5883\u5df2\u7ecf\u51c6\u5907\u597d\u4e86\u3002\u8fd9\u91cc\u6709\u70b9\u4e0d\u592a\u7406\u89e3\u7684\u5730\u65b9\uff0c\u4e3a\u4ec0\u4e48\u4e0d\u662f\u6700\u540e\u518d\u53d1\u5e03\u73af\u5883\u4e8b\u4ef6\uff0c\u800c\u8981\u5728 compiler.options \u8bbe\u7f6e\u4e4b\u524d\u5462\uff1f\u4e0d\u8fc7\u8fd9\u4e2a\u7ec6\u8282\u6216\u8bb8\u4e5f\u4e0d\u592a\u91cd\u8981\u3002"),(0,i.kt)("h2",{id:"\u5185\u7f6e\u63d2\u4ef6\u5b89\u88c5"},"\u5185\u7f6e\u63d2\u4ef6\u5b89\u88c5"),(0,i.kt)("p",null,"\u6700\u540e\u662f\u6839\u636e\u4f20\u9012\u7684 options\uff0c\u53bb\u5b89\u88c5\u5185\u7f6e\u63d2\u4ef6"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"compiler.options = new WebpackOptionsApply().process(options, compiler);\n")),(0,i.kt)("p",null,"\u8fd9\u4e2a\u521d\u59cb\u5316\u8d1f\u8d23\u5c06 options \u53c2\u6570\uff0c\u8f6c\u6362\u4e3a Webpack \u5185\u90e8\u63d2\u4ef6\u6765\u5904\u7406\uff0c\u90e8\u5206\u5185\u5bb9\u5982\u4e0b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'class WebpackOptionsApply extends OptionsApply {\n  // ...\n  process(options, compiler) {\n    // ...\n    new EntryOptionPlugin().apply(compiler); // \u5728\u8fd9\u91cc\u5bf9 entry \u591a\u79cd\u914d\u7f6e\u5f62\u5f0f\u8fdb\u884c\u4e86\u7edf\u4e00\u5904\u7406\u8f6c\u6362\n    compiler.hooks.entryOption.call(options.context, options.entry);\n    // ...\n    if (typeof options.mode !== "string") {\n      const WarnNoModeSetPlugin = require("./WarnNoModeSetPlugin");\n      new WarnNoModeSetPlugin().apply(compiler);\n    }\n    if (options.optimization.removeAvailableModules) {\n      const RemoveParentModulesPlugin = require("./optimize/RemoveParentModulesPlugin");\n      new RemoveParentModulesPlugin().apply(compiler);\n    }\n    if (options.optimization.removeEmptyChunks) {\n      const RemoveEmptyChunksPlugin = require("./optimize/RemoveEmptyChunksPlugin");\n      new RemoveEmptyChunksPlugin().apply(compiler);\n    }\n    // ...\n    return options;\n  }\n}\n')),(0,i.kt)("p",null,"\u4ee5\u4e0a\u53ea\u5c55\u793a\u4e86\u539f\u4ee3\u7801\u7684\u4e00\u5c0f\u90e8\u5206\u5185\u5bb9\uff0c\u6982\u62ec\u6765\u8bf4\uff0c\u8fd9\u5c31\u662f\u6839\u636e options \u4e2d\u7684\u914d\u7f6e\uff0c\u5f15\u5165\u4e00\u4e2a\u4e2a\u5185\u90e8\u63d0\u4f9b\u7684\u63d2\u4ef6\u8fdb\u884c\u5904\u7406\u3002\u57fa\u672c\u4e0a\u662f\u4e0b\u9762\u8fd9\u6837\u7684\u4e00\u4e2a\u8f6c\u6362"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"if (options.somePlugin) {\n  const Plugin = require('./relative/path/to/somePlugin')\uff1b\n  new Plugin().apply(compiler);\n}\n")),(0,i.kt)("p",null,"\u8fd9\u4e00\u6b65\u5c06 webpack \u63d2\u4ef6\u7684\u8bbe\u8ba1\u4f53\u73b0\u7684\u6dcb\u6f13\u5c3d\u81f4\u3002"),(0,i.kt)("h2",{id:"\u51c6\u5907\u5f00\u59cb\u7f16\u8bd1"},"\u51c6\u5907\u5f00\u59cb\u7f16\u8bd1"),(0,i.kt)("p",null,"\u521b\u5efa compiler \u4e4b\u540e\u8c03\u7528 ",(0,i.kt)("inlineCode",{parentName:"p"},"compiler.run")," \u5f00\u59cb\u6267\u884c\u7f16\u8bd1\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u6838\u5fc3\u8fc7\u7a0b\u5982\u4e0b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="webpack/lib/Compiler.js"',title:'"webpack/lib/Compiler.js"'},"run(callback) {\n  // ...\n\n  this.hooks.beforeRun.callAsync(this, err => {\n    if (err) return finalCallback(err);\n\n    this.hooks.run.callAsync(this, err => {\n      if (err) return finalCallback(err);\n\n      this.readRecords(err => {\n        if (err) return finalCallback(err);\n\n        this.compile(onCompiled);\n      });\n    });\n  });\n}\n")),(0,i.kt)("p",null,"\u4ece\u4e0a\u9762\u770b\uff0c\u4f9d\u6b21\u89e6\u53d1 ",(0,i.kt)("inlineCode",{parentName:"p"},"beforeRun"),"\uff0c",(0,i.kt)("inlineCode",{parentName:"p"},"run")," \u4e24\u4e2a\u4e8b\u4ef6\uff0c\u8fd9\u4e24\u4e2a\u4e8b\u4ef6\u7684\u56de\u8c03\u6267\u884c\u5b8c\u6210\u4e4b\u540e\uff0c\u6700\u7ec8\u8c03\u7528 compile \u51fd\u6570\u3002compile \u8868\u793a\u4e00\u6b21\u7f16\u8bd1\uff0conCompiled \u8fd9\u4e2a\u56de\u8c03\u51fd\u6570\u662f\u7f16\u8bd1\u5b8c\u6210\u4e4b\u540e\u6267\u884c\u7684\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="lib/Compiler.js"',title:'"lib/Compiler.js"'},"compile(callback) {\n  const params = this.newCompilationParams();\n  this.hooks.beforeCompile.callAsync(params, err => {\n    this.hooks.compile.call(params);\n    // highlight-next-line\n    const compilation = this.newCompilation(params);\n    // highlight-next-line\n    this.hooks.make.callAsync(compilation, err => {\n      process.nextTick(() => {\n        // highlight-next-line\n        compilation.finish(err => {\n          // highlight-next-line\n          compilation.seal(err => {\n            this.hooks.afterCompile.callAsync(compilation, err => {\n              return callback(null, compilation);\n            });\n          });\n        });\n      });\n    });\n  });\n}\n")),(0,i.kt)("p",null,"\u4ee5\u4e0a\u4f9d\u6b21\u89e6\u53d1\u4e86 ",(0,i.kt)("inlineCode",{parentName:"p"},"beforeCompile"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"compile"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"make")," \u4e8b\u4ef6\uff0c\u4ece\u8c03\u7528 compiler.run \u5230 hooks.make\uff0c\u90fd\u53ea\u662f\u5728\u505a\u51c6\u5907\u5de5\u4f5c\uff0c\u6bcf\u4e2a\u8282\u70b9\u90fd\u901a\u77e5\u4e00\u4e0b\uff0c\u5230\u4e86 make \u8fd9\u4e2a\u4f4d\u7f6e\uff0c\u624d\u662f\u6700\u540e\u5927\u54c4\u4e00\u58f0 \u2014\u2014 \u73b0\u5728\u771f\u7684\u8981\u5f00\u59cb\u4e86 \ud83d\ude02\u3002"),(0,i.kt)("h2",{id:"\u5c0f\u7ed3"},"\u5c0f\u7ed3"),(0,i.kt)("p",null,"\u603b\u7ed3\u6765\u8bf4\uff0ccompiler \u521d\u59cb\u5316\u7684\u8fc7\u7a0b\uff0c\u90fd\u56f4\u7ed5\u7740 hooks \u548c plugins \u8fdb\u884c"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5b9a\u4e49\u4e8b\u4ef6\uff1a\u7f16\u8bd1\u5668\u652f\u6301\u90a3\u4e9b\u4e8b\u4ef6"),(0,i.kt)("li",{parentName:"ul"},"\u8ba2\u9605\u4e8b\u4ef6\uff1a\u6216\u8005\u4e5f\u53ef\u4ee5\u8bf4\u662f\u5b89\u88c5\u63d2\u4ef6\uff0c\u901a\u8fc7\u914d\u7f6e\u7684\uff0c\u5185\u7f6e\u7684\u63d2\u4ef6\u8ba2\u9605\u4e86\u7f16\u8bd1\u8fc7\u7a0b\u7684\u4e8b\u4ef6"),(0,i.kt)("li",{parentName:"ul"},"\u53d1\u5e03\u4e8b\u4ef6\uff1a\u521d\u59cb\u5316\u672c\u8eab\u4e5f\u662f\u7f16\u8bd1\u8fc7\u7a0b\u7684\u4e00\u90e8\u5206\uff0c\u6709\u4e00\u4e9b\u4e8b\u4ef6\u8282\u70b9")),(0,i.kt)("p",null,"\u6216\u8005\u6700\u7b80\u5355\u6765\u8bf4\uff0ccompiler \u7684\u521d\u59cb\u5316\u8fc7\u7a0b\uff0c\u5c31\u5f53\u505a\u662f\u4e0b\u9762\u8fd9\u6837 3 \u4e2a\u6b65\u9aa4\u5c31\u53ef\u4ee5"),(0,i.kt)("mermaid",{value:"%%{init: { 'logLevel': 'debug', 'theme': 'base',  'gitGraph': { 'mainBranchName': 'compiler'}} }%%\n  gitGraph\n  commit id:\"\u5b9a\u4e49\u4e8b\u4ef6\"\n  commit id:\"\u5b89\u88c5\u63d2\u4ef6\"\n  commit id:\"\u6267\u884c\u7f16\u8bd1\""}),(0,i.kt)("p",null,"\u8ba9\u6211\u89c9\u5f97\u5f88\u53d7\u542f\u53d1\u7684\uff0c\u662f options \u914d\u7f6e\u7684\u5404\u9879\u8f6c\u6362\u4e3a\u63d2\u4ef6\u8fd9\u4e2a\u5904\u7406\uff0c\u5f88\u6709\u610f\u601d\u3002"),(0,i.kt)("admonition",{title:"\ud83e\udd14",type:"info"},(0,i.kt)("p",{parentName:"admonition"},"\u672c\u6587\u53ea\u662f\u7f16\u8bd1\u8fc7\u7a0b\u7684\u4e00\u4e2a\u4e3b\u8981\u6d41\u7a0b\u6982\u89c8\uff0c\u771f\u7684\u6df1\u5165\u53bb\u770b\u66f4\u7ec6\u8282\u7684\u5185\u5bb9\u7684\u8bdd\uff0c\u8fd8\u6709\u5f88\u591a\u5f88\u591a\uff0c\u6bd4\u5982\u5185\u7f6e\u63d2\u4ef6\u5b89\u88c5\u7684\u8fc7\u7a0b\uff0c\u5982\u4f55\u5b9e\u73b0 watch \u91cd\u65b0\u7f16\u8bd1\u7b49\uff0c\u8fd9\u4e9b\u5185\u5bb9\u8fc7\u7ec6\u4e86\uff0c\u6682\u65f6\u5148\u628a\u63e1\u4e3b\u6d41\u7a0b\u5373\u53ef\u3002")))}u.isMDXComponent=!0}}]);